!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react"),require("infestines")):"function"==typeof define&&define.amd?define(["exports","react","infestines"],r):r(n.xaret={},n.React,n.I)}(this,function(n,r,e){"use strict";function t(n,r,i){if(U(n))return i[++r[0]];if(e.isArray(n)){for(var s=n,u=0,o=n.length;u<o;++u){var a=n[u],l=a;U(a)?l=i[++r[0]]:e.isArray(a)&&(l=t(a,r,i)),l!==a&&(s===n&&(s=n.slice(0)),s[u]=l)}return s}return n}function i(n,r,e){var t=void 0;for(var i in n){var s=n[i];if(U(s)){if(!t){t={};for(var u in n){if(u===i)break;t[u]=n[u]}}t[i]=e[++r[0]]}else t&&(t[i]=s)}return t||n}function s(n,r){var e=null,s=null,u=null,o=[-1];for(var a in n){var l=n[a];y===a?u=t(l,o,r):"$$type"===a?e=n[a]:x===a?(s=s||{}).ref=U(l)?r[++o[0]]:l:U(l)?(s=s||{})[a]=r[++o[0]]:d===a?(s=s||{}).style=i(l,o,r)||l:(s=s||{})[a]=l}return u instanceof Array?A.apply(null,[e,s].concat(u)):u?A(e,s,u):A(e,s)}function u(n,r,t){for(var i=0,s=n.length;i<s;++i){var o=n[i];U(o)?t(r,o):e.isArray(o)&&u(o,r,t)}}function o(n,r,t){for(var i in n){var s=n[i];if(U(s))t(r,s);else if(y===i)e.isArray(s)&&u(s,r,t);else if(d===i)for(var o in s){var a=s[o];U(a)&&t(r,a)}}}function a(n){n.values+=1}function l(n,r){n.subscription=r.subscribe(n.next,n.error,n.complete)}function f(n,r){var e=function r(){for(var e=n.handlers,t=0;e[t]!==r;)++t;r.next=function(r){var e=n.values;e[t]!==r&&(e[t]=r,n.forceUpdate())},r.error=function(n){throw n},r.complete=function(){e[t]=null;var r=e.length;if(r===n.values.length){for(var i=0;i<r;++i)if(e[i])return;n.handlers=null}}};n.handlers.push(e),l(e,r)}function c(n){n.subscription&&n.subscription.unsubscribe()}function h(n,r){for(var t=r.length;n<t;++n){var i=r[n];if(U(i)||e.isArray(i)&&h(0,i))return!0}return!1}function v(n){for(var r in n){var t=n[r];if(U(t))return!0;if(y===r){if(e.isArray(t)&&h(0,t))return!0}else if(d===r)for(var i in t)if(U(t[i]))return!0}return!1}function p(n,r){var e={$$type:n};for(var t in r){var i=r[t];"ref"===t?e[x]=i:m!==t&&(e[t]=i)}return e}var b=require("rxjs/Rx"),d="style",y="children",m="xaret-lift",x="$$ref",A=r.createElement,g=r.Component,U=function(n){return n instanceof b.Observable},$=e.inherit(function(n){g.call(this,n)},g,{componentWillReceiveProps:function(n){this.componentWillUnmount(),this.doSubscribe(n)},componentWillMount:function(){this.doSubscribe(this.props)}}),j=e.inherit(function(n){$.call(this,n),this.callback=null,this.rendered=null},$,{componentWillUnmount:function(){this.subscription&&this.subscription.unsubscribe()},doSubscribe:function(n){var r=this,e=n.observable;if(U(e)){this.subscription=e.subscribe(function(n){r.rendered=n||null,r.forceUpdate()},function(n){throw n},function(){r.subscription=null})}else this.rendered=e||null},render:function(){return this.rendered}}),S=e.inherit(function(n){$.call(this,n),this.values=this,this.handlers=null},$,{componentWillUnmount:function(){var n=this.handlers;n instanceof Function?n.subscription.unsubscribe():n&&n.forEach(c)},doSubscribe:function(n){var r=this;this.values=0,o(n,this,a);var t=this.values;switch(t){case 0:this.values=e.array0;break;case 1:this.values=this;var i=function(){};i.next=function(n){r.values!==n&&(r.values=n,r.forceUpdate())},i.error=function(n){throw n},i.complete=function(){r.values=[r.values],r.handlers=null},this.handlers=i,o(n,i,l);break;default:this.values=Array(t).fill(this),this.handlers=[],o(n,this,f)}},render:function(){if(this.handlers instanceof Function){var n=this.values;return n===this?null:s(this.props,[n])}for(var r=this.values,e=0,t=r.length;e<t;++e)if(r[e]===this)return null;return s(this.props,r)}});n.fromRx=function(n){return A(j,{observable:n})},n.createElement=function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];var i=r[0],s=r[1]||e.object0;return(e.isString(i)||s[m])&&(h(2,r)||v(s)?(r[1]=p(i,s),r[0]=S):s[m]&&(r[1]=e.dissocPartialU(m,s)||e.object0)),A.apply(void 0,r)},n.fromClass=function(n){return function(r){return A(S,p(n,r))}},Object.defineProperty(n,"__esModule",{value:!0})});
